# ğŸ‰ Zentao-MCP é˜¶æ®µå››å®ŒæˆæŠ¥å‘Š

## ğŸ“‹ é˜¶æ®µå››éœ€æ±‚å›é¡¾
æ ¹æ® `design/ai-step.md` çš„è¦æ±‚ï¼Œé˜¶æ®µå››çš„ç›®æ ‡æ˜¯ï¼š**è·å–bugåˆ—è¡¨**

### æ¶‰åŠçš„æ•°æ®è¡¨
1. **zt_user** - äººå‘˜æ•°æ®è¡¨
2. **zt_bug** - bugæ•°æ®è¡¨
3. **zt_module** - åŠŸèƒ½æ¨¡å—æ•°æ®è¡¨

### å­—æ®µæ˜ å°„

#### zt_userè¡¨
- `account`: äººå‘˜å…¨å±€å”¯ä¸€æ ‡è¯†ï¼Œå…¶å®ƒè¡¨çš„PO,PM,QD,RDéƒ½å¯¹åº”è¿™ä¸ªå€¼
- `realname`: äººå‘˜çœŸå®å§“å
- `role`: äººå‘˜èŒä½

#### zt_bugè¡¨
- `id`: bugå”¯ä¸€ç¼–å·
- `product`: bugå¯¹åº”çš„äº§å“
- `project`: bugå¯¹åº”çš„é¡¹ç›®
- `module`: bugå¯¹åº”çš„åŠŸèƒ½æ¨¡å—ï¼Œå¯¹åº”zt_moduleè¡¨
- `title`: bugæ ‡é¢˜æè¿°
- `severity`: bugä¸¥é‡ç¨‹åº¦
- `pri`: bugéœ€è¦å¤„ç†çš„ä¼˜å…ˆçº§
- `steps`: bugäº§ç”Ÿçš„è¿‡ç¨‹æè¿°
- `status`: bugçš„çŠ¶æ€
- `openedBy`: ä¿®æ”¹statusä¸ºOpençš„äººå‘˜
- `openedDate`: ä¿®æ”¹statusä¸ºOpençš„æ—¶é—´
- `assignedTo`: å½“å‰è´Ÿè´£äºº
- `assignedDate`: æœ€è¿‘çš„æŒ‡æ´¾æ—¶é—´
- `resolvedBy`: è§£å†³bugçš„äººå‘˜
- `resolvedDate`: è§£å†³çš„æ—¶é—´
- `closedBy`: å…³é—­bugçš„äººå‘˜
- `closedDate`: å…³é—­bugçš„æ—¶é—´

#### zt_moduleè¡¨
- `id`: å…¨å±€å”¯ä¸€æ ‡è¯†
- `name`: åŠŸèƒ½æ¨¡å—åç§°

## âœ… é˜¶æ®µå››å®ç°å®Œæˆæƒ…å†µ

### 1. æ•°æ®åº“å±‚åŠŸèƒ½ âœ…
åœ¨ `ZentaoDatabase` ç±»ä¸­æ–°å¢äº†ä»¥ä¸‹æ–¹æ³•ï¼š

#### `get_bugs(limit, product_id, project_id, status)`
- è·å–Bugåˆ—è¡¨ï¼Œæ”¯æŒå¤šç§è¿‡æ»¤æ¡ä»¶
- ä½¿ç”¨å¤æ‚çš„JOINæŸ¥è¯¢å…³è”å¤šä¸ªè¡¨
- åŒ…å«ç”¨æˆ·çœŸå®å§“åã€äº§å“åç§°ã€é¡¹ç›®åç§°ã€æ¨¡å—åç§°
- æ”¯æŒæŒ‰äº§å“IDã€é¡¹ç›®IDã€çŠ¶æ€ç­›é€‰
- å¯é™åˆ¶è¿”å›è®°å½•æ•°é‡

#### `get_users()`
- è·å–ç³»ç»Ÿç”¨æˆ·åˆ—è¡¨
- è¿”å›è´¦å·ã€çœŸå®å§“åã€è§’è‰²ä¿¡æ¯
- ä¸ºBugæŸ¥è¯¢æä¾›äººå‘˜ä¿¡æ¯æ”¯æŒ

#### `get_modules(product_id)`
- è·å–åŠŸèƒ½æ¨¡å—åˆ—è¡¨
- æ”¯æŒæŒ‰äº§å“IDç­›é€‰
- ä¸ºBugåˆ†ç±»æä¾›æ¨¡å—ä¿¡æ¯

### 2. MCPå·¥å…·æ¥å£ âœ…
æ–°å¢äº†ä¸‰ä¸ªMCPå·¥å…·ï¼š

#### å·¥å…·1ï¼š`get_bugs`
```json
{
  "name": "get_bugs",
  "title": "è·å–Bugåˆ—è¡¨",
  "description": "è·å–ç¦…é“ç³»ç»Ÿä¸­Bugçš„åˆ—è¡¨ï¼ŒåŒ…æ‹¬Bug IDã€æ ‡é¢˜ã€çŠ¶æ€ã€æŒ‡æ´¾äººç­‰ä¿¡æ¯",
  "inputSchema": {
    "type": "object",
    "properties": {
      "limit": {
        "type": "integer",
        "description": "è¿”å›è®°å½•çš„æ•°é‡ï¼Œæœ€å¤§å€¼200",
        "default": 50
      },
      "product_id": {
        "type": "integer",
        "description": "æŒ‰äº§å“IDè¿‡æ»¤"
      },
      "project_id": {
        "type": "integer", 
        "description": "æŒ‰é¡¹ç›®IDè¿‡æ»¤"
      },
      "status": {
        "type": "string",
        "description": "æŒ‰çŠ¶æ€è¿‡æ»¤"
      }
    },
    "required": []
  }
}
```

#### å·¥å…·2ï¼š`list_users`
```json
{
  "name": "list_users",
  "title": "è·å–ç”¨æˆ·åˆ—è¡¨",
  "description": "è·å–ç¦…é“ç³»ç»Ÿä¸­ç”¨æˆ·çš„åˆ—è¡¨ï¼ŒåŒ…æ‹¬ç”¨æˆ·è´¦å·ã€å§“åã€è§’è‰²ç­‰ä¿¡æ¯",
  "inputSchema": {
    "type": "object",
    "properties": {},
    "required": []
  }
}
```

#### å·¥å…·3ï¼š`list_modules`
```json
{
  "name": "list_modules",
  "title": "è·å–æ¨¡å—åˆ—è¡¨", 
  "description": "è·å–ç¦…é“ç³»ç»Ÿä¸­åŠŸèƒ½æ¨¡å—çš„åˆ—è¡¨ï¼ŒåŒ…æ‹¬æ¨¡å—IDã€åç§°ã€æ‰€å±äº§å“ç­‰ä¿¡æ¯",
  "inputSchema": {
    "type": "object",
    "properties": {
      "product_id": {
        "type": "integer",
        "description": "æŒ‰äº§å“IDè¿‡æ»¤"
      }
    },
    "required": []
  }
}
```

### 3. é«˜çº§æŸ¥è¯¢åŠŸèƒ½ âœ…

#### å¤æ‚JOINæŸ¥è¯¢
BugæŸ¥è¯¢ä½¿ç”¨äº†å¤šè¡¨å…³è”ï¼Œä¸€æ¬¡æ€§è·å–å®Œæ•´ä¿¡æ¯ï¼š
```sql
SELECT 
    b.id, b.product, b.project, b.module, b.title, b.severity, b.pri,
    b.steps, b.status, b.openedBy, b.openedDate, b.assignedTo, b.assignedDate,
    b.resolvedBy, b.resolvedDate, b.closedBy, b.closedDate,
    p.name as product_name,
    proj.name as project_name,
    m.name as module_name,
    u_opened.realname as opened_by_name,
    u_assigned.realname as assigned_to_name,
    u_resolved.realname as resolved_by_name,
    u_closed.realname as closed_by_name
FROM zt_bug b
LEFT JOIN zt_product p ON b.product = p.id
LEFT JOIN zt_project proj ON b.project = proj.id
LEFT JOIN zt_module m ON b.module = m.id
LEFT JOIN zt_user u_opened ON b.openedBy = u_opened.account
LEFT JOIN zt_user u_assigned ON b.assignedTo = u_assigned.account
LEFT JOIN zt_user u_resolved ON b.resolvedBy = u_resolved.account
LEFT JOIN zt_user u_closed ON b.closedBy = u_closed.account
```

#### çµæ´»çš„ç­›é€‰æ¡ä»¶
- **äº§å“ç­›é€‰**: æŒ‰äº§å“IDè¿‡æ»¤Bug
- **é¡¹ç›®ç­›é€‰**: æŒ‰é¡¹ç›®IDè¿‡æ»¤Bug
- **çŠ¶æ€ç­›é€‰**: æŒ‰BugçŠ¶æ€è¿‡æ»¤
- **æ•°é‡é™åˆ¶**: é˜²æ­¢ä¸€æ¬¡æ€§è¿”å›è¿‡å¤šæ•°æ®

### 4. è¿”å›æ•°æ®æ ¼å¼ âœ…
ç¬¦åˆMCPè¦æ±‚çš„å®Œæ•´æ•°æ®ç»“æ„ï¼š

```json
{
  "bugs": [
    {
      "id": 1,
      "product": 1,
      "project": 1,
      "module": 1,
      "title": "ç¤ºä¾‹Bugæ ‡é¢˜",
      "severity": "2",
      "pri": "3",
      "steps": "é‡ç°æ­¥éª¤æè¿°...",
      "status": "active",
      "openedBy": "admin",
      "openedDate": "2024-01-01 10:00:00",
      "assignedTo": "developer01",
      "assignedDate": "2024-01-01 11:00:00",
      "resolvedBy": null,
      "resolvedDate": null,
      "closedBy": null,
      "closedDate": null,
      "product_name": "ç¤ºä¾‹äº§å“",
      "project_name": "ç¤ºä¾‹é¡¹ç›®",
      "module_name": "ç™»å½•æ¨¡å—",
      "opened_by_name": "ç®¡ç†å‘˜",
      "assigned_to_name": "å¼€å‘äººå‘˜",
      "resolved_by_name": null,
      "closed_by_name": null
    }
  ],
  "total_bugs": 1,
  "filters": {
    "limit": 50,
    "product_id": null,
    "project_id": null,
    "status": null
  }
}
```

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•æ–‡ä»¶
- **`test/test_stage_four_http.py`** - Bugç®¡ç†HTTPæµ‹è¯•æœåŠ¡å™¨

### æµ‹è¯•è¦†ç›–
- âœ… **BugæŸ¥è¯¢æµ‹è¯•**: æ”¯æŒå„ç§ç­›é€‰æ¡ä»¶
- âœ… **ç”¨æˆ·æŸ¥è¯¢æµ‹è¯•**: å®Œæ•´çš„ç”¨æˆ·åˆ—è¡¨è·å–
- âœ… **æ¨¡å—æŸ¥è¯¢æµ‹è¯•**: æ”¯æŒæŒ‰äº§å“ç­›é€‰çš„æ¨¡å—æŸ¥è¯¢
- âœ… **å…³è”æŸ¥è¯¢æµ‹è¯•**: éªŒè¯å¤šè¡¨JOINçš„æ­£ç¡®æ€§
- âœ… **å‚æ•°éªŒè¯æµ‹è¯•**: éªŒè¯å„ç§è¾“å…¥å‚æ•°çš„å¤„ç†
- âœ… **é”™è¯¯å¤„ç†æµ‹è¯•**: éªŒè¯å¼‚å¸¸æƒ…å†µçš„å¤„ç†

### å¯è§†åŒ–æµ‹è¯•ç•Œé¢
åˆ›å»ºäº†ä¸“é—¨çš„Bugç®¡ç†æµ‹è¯•ç•Œé¢ï¼ˆç«¯å£8082ï¼‰ï¼Œæä¾›ï¼š
- **å¤šæ¡ä»¶BugæŸ¥è¯¢**: æŒ‰æ•°é‡ã€äº§å“ã€é¡¹ç›®ã€çŠ¶æ€ç­›é€‰
- **ç”¨æˆ·ç®¡ç†**: æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·åˆ—è¡¨
- **æ¨¡å—ç®¡ç†**: æŸ¥çœ‹åŠŸèƒ½æ¨¡å—ï¼Œæ”¯æŒæŒ‰äº§å“ç­›é€‰
- **æ•°æ®ç»Ÿè®¡**: å®æ—¶æ˜¾ç¤ºå„ç±»æ•°æ®çš„æ•°é‡ç»Ÿè®¡
- **å®æ—¶æµ‹è¯•**: ä¾¿äºè°ƒè¯•å’ŒéªŒè¯åŠŸèƒ½

## ğŸŒ å½“å‰è¿è¡ŒçŠ¶æ€

### æœåŠ¡å™¨çŠ¶æ€
- **é˜¶æ®µå››Bugç®¡ç†æµ‹è¯•æœåŠ¡å™¨**: http://localhost:8082 âœ… è¿è¡Œä¸­
- **ä¸»MCPæœåŠ¡å™¨**: å·²é›†æˆé˜¶æ®µå››çš„ä¸‰ä¸ªæ–°å·¥å…·
- **å®Œæ•´å·¥å…·åˆ—è¡¨**: 5ä¸ªMCPå·¥å…·å…¨éƒ¨å¯ç”¨

### å¯ç”¨å·¥å…·åˆ—è¡¨
1. `list_products` - è·å–äº§å“åˆ—è¡¨ (é˜¶æ®µäºŒ)
2. `get_projects_by_product` - é€šè¿‡äº§å“åè·å–é¡¹ç›® (é˜¶æ®µä¸‰)
3. `get_bugs` - è·å–Bugåˆ—è¡¨ ğŸ†• (é˜¶æ®µå››)
4. `list_users` - è·å–ç”¨æˆ·åˆ—è¡¨ ğŸ†• (é˜¶æ®µå››)
5. `list_modules` - è·å–æ¨¡å—åˆ—è¡¨ ğŸ†• (é˜¶æ®µå››)

## ğŸ¯ é˜¶æ®µå››å®Œæˆæ€»ç»“

### âœ… å·²å®ŒæˆåŠŸèƒ½
- [x] **Bugæ•°æ®æŸ¥è¯¢**: å®Œæ•´çš„Bugä¿¡æ¯è·å–
- [x] **ç”¨æˆ·æ•°æ®æŸ¥è¯¢**: ç³»ç»Ÿç”¨æˆ·ä¿¡æ¯ç®¡ç†
- [x] **æ¨¡å—æ•°æ®æŸ¥è¯¢**: åŠŸèƒ½æ¨¡å—ä¿¡æ¯ç®¡ç†
- [x] **å¤šè¡¨å…³è”**: é«˜æ•ˆçš„JOINæŸ¥è¯¢å®ç°
- [x] **æ¡ä»¶ç­›é€‰**: çµæ´»çš„æ•°æ®è¿‡æ»¤æœºåˆ¶
- [x] **MCPå·¥å…·**: å®Œæ•´çš„å·¥å…·å®šä¹‰å’Œå®ç°
- [x] **æµ‹è¯•è¦†ç›–**: å…¨é¢çš„åŠŸèƒ½æµ‹è¯•
- [x] **å¯è§†åŒ–ç•Œé¢**: ä¾¿äºè°ƒè¯•çš„Webç•Œé¢

### ğŸ“Š æŠ€æœ¯ç‰¹ç‚¹
1. **å¤æ‚æŸ¥è¯¢**: 7è¡¨JOINæŸ¥è¯¢ï¼Œä¸€æ¬¡æ€§è·å–å®Œæ•´ä¿¡æ¯
2. **æ€§èƒ½ä¼˜åŒ–**: åˆç†çš„æ•°æ®é‡é™åˆ¶å’Œç´¢å¼•ä½¿ç”¨
3. **ç”¨æˆ·å‹å¥½**: è¿”å›è´¦å·å’ŒçœŸå®å§“ååŒé‡ä¿¡æ¯
4. **çµæ´»ç­›é€‰**: æ”¯æŒå¤šç»´åº¦çš„æ•°æ®è¿‡æ»¤
5. **æ ‡å‡†å…¼å®¹**: å®Œå…¨ç¬¦åˆMCPåè®®æ ‡å‡†

### ğŸ”„ ä¸å‰ä¸‰ä¸ªé˜¶æ®µçš„é›†æˆ
- **é˜¶æ®µä¸€**: æ•°æ®åº“è¿æ¥åŸºç¡€ âœ…
- **é˜¶æ®µäºŒ**: äº§å“æ•°æ®æŸ¥è¯¢ âœ…  
- **é˜¶æ®µä¸‰**: é¡¹ç›®å…³è”æŸ¥è¯¢ âœ…
- **é˜¶æ®µå››**: Bugç®¡ç†ç³»ç»Ÿ âœ… æ–°å¢

ç°åœ¨ç¦…é“MCPæœåŠ¡å™¨å…·å¤‡äº†å®Œæ•´çš„é¡¹ç›®ç®¡ç†æ•°æ®è®¿é—®èƒ½åŠ›ï¼

## ğŸŒŸ ä¸šåŠ¡ä»·å€¼

1. **Bugè·Ÿè¸ª**: å®Œæ•´çš„Bugç”Ÿå‘½å‘¨æœŸç®¡ç†
2. **äººå‘˜ç®¡ç†**: æ¸…æ™°çš„è´£ä»»äººè¿½è¸ª
3. **æ¨¡å—ç®¡ç†**: ç²¾ç¡®çš„åŠŸèƒ½æ¨¡å—åˆ†ç±»
4. **æ•°æ®é›†æˆ**: ä¸ºAIåŠ©æ‰‹æä¾›ä¸°å¯Œçš„é¡¹ç›®ç®¡ç†æ•°æ®
5. **è´¨é‡ç®¡æ§**: æ”¯æŒBugç»Ÿè®¡å’Œåˆ†æ

---

## ğŸ† ç»“è®º
**é˜¶æ®µå››çš„æ‰€æœ‰éœ€æ±‚å·²å…¨éƒ¨å®ç°å®Œæˆï¼** 

ç¦…é“MCPæœåŠ¡å™¨ç°åœ¨å…·å¤‡å®Œæ•´çš„Bugç®¡ç†èƒ½åŠ›ï¼Œç»“åˆå‰ä¸‰ä¸ªé˜¶æ®µçš„åŠŸèƒ½ï¼Œå·²ç»æˆä¸ºä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„é¡¹ç›®ç®¡ç†æ•°æ®è®¿é—®å¹³å°ï¼Œä¸ºAIåŠ©æ‰‹æä¾›äº†å…¨é¢çš„ç¦…é“ç³»ç»Ÿé›†æˆèƒ½åŠ›ã€‚
